function GameInit(n,t,i,r,u,f,e){g_lang=n;GameUpdateCharacter();GameUpdateGold();GameUpdateArtifacts();GameUpdateSkills();GameUpdateInventoryWeight();GameUpdateInventoryEquipment();GameUpdateRankingHunt();$("#layer1").tooltip({title:t,container:"body"});$("#layer1").click(function(){LoadArea(UI.Shop)});$("#g6019Mobile").click(function(){LoadArea(UI.Shop,null,1)});$("#layer5").tooltip({title:i,container:"body"});$("#layer5, #g12664Mobile").click(function(){$("#md-jobs").niftyModal();$('input:radio[name="radJob"]').change(function(){g_currentJobId=$(this).val();$("#jobsProceed").prop("disabled",!1)})});$("#layer2").tooltip({title:r,container:"body"});$("#layer3").tooltip({title:u,container:"body",placement:"right"});$("#layer3, #g5832Mobile").click(function(){LoadArea(UI.Tavern,null,1)});$("#layer4").tooltip({title:f,container:"body"});$("#layer4, #layer1-89Mobile").click(function(){$.getJSON("/Game/AjaxGetCarePrice",function(n){$.each(n,function(n,t){$("#apothecaryCarePrice").text(t)})});$("#md-apothecary").niftyModal()});$("#layer7").tooltip({title:e,container:"body",placement:"right"});$("#layer7").click(function(){LoadArea(UI.Manor)});$("#layer1-6Mobile").click(function(){LoadArea(UI.Manor,null,1)});$("#CompanionManagementOpen").click(function(){LoadArea(UI.CompanionManagement)});GameUpdateCompanion(),function(){$.ajax({dataType:"json",url:"/Game/AjaxGetWork",success:function(n){$.each(n,function(n,t){t.Success=="true"&&(g_currentJobId=t.JobId,LoadArea(UI.AtWork,function(){var n=t.AtWorkStart.split("/");$("#atWorkProgressBar").progressTimer({timeLimit:$("#TimeInput"+g_currentJobId).val(),start:new Date(t.AtWorkStart),baseStyle:"progress-bar-primary progress-bar-striped active",warningStyle:"progress-bar-primary progress-bar-striped active",completeStyle:"progress-bar-success progress-bar-striped active",eachIteration:function(n){var t=Math.ceil(($("#TimeInput"+g_currentJobId).val()*1e3-n)/3e5);t<1?$("#atWorkArtifactPrice").text("1"):$("#atWorkArtifactPrice").text(t)},onFinish:function(){$("#atWorkBtn").empty();$("#atWorkBtn").html('<a onclick="RecoverJob()" class="btn btn-space btn-success"><i class="icon icon-left mdi mdi-check"><\/i> '+t.ButtonTxt+"<\/a>")}})}))})}});$.ajax({dataType:"json",url:"/Game/AjaxGetHeroQuest",success:function(n){$.each(n,function(n,t){t.Success=="true"&&StartHeroQuest(t.QuestId)})}});GameUpdateCharacter();setTimeout(arguments.callee,3e4)}()}function GameUpdateCharacter(){$.getJSON("/Game/AjaxGetCharacter",function(n){$.each(n,function(n,t){game.GetPlayer().Level=t.Level;game.GetPlayer().Xp=t.Xp;GameUpdateLife();game.GetPlayer().Defense=t.Defense;game.GetPlayer().Energy=t.Energy;game.GetPlayer().Strength=t.Strength;game.GetPlayer().DefenseAdd=t.DefenseAdd;game.GetPlayer().EnergyAdd=t.EnergyAdd;game.GetPlayer().StrengthAdd=t.StrengthAdd;g_skillPointsDiv=t.Points;g_skillPointsDiv>0?$(".awardSkillsPoints").show():(g_skillPointsDiv=0,$(".awardSkillsPoints").hide())});game.Update()})}function GameUpdateGold(){$.getJSON("/Game/AjaxGetGold",function(n){$.each(n,function(n,t){game.gold=t;game.Update()})})}function GameUpdateLife(){$.getJSON("/Game/AjaxGetLife",function(n){$.each(n,function(n,t){game.GetPlayer().Life=t;game.GetPlayer().Update()})})}function GameUpdateArtifacts(){$.getJSON("/Game/AjaxGetArtifacts",function(n){$.each(n,function(n,t){game.artifacts=t;game.Update()})})}function GameUpdateInventoryWeight(){$.getJSON("/Game/AjaxGetInventoryWeight",function(n){$.each(n,function(n,t){$("#JsWeight").text(t.Weight+"/"+t.Space)})})}function LoadArea(n,t,i=0,r){if(game.UI!=UI.HeroQuest&&game.UI!=UI.AtNarrativeQuest&&game.UI!=UI.AtWork){game.UI!=UI.City&&CloseArea();$("#gameContentDiv").empty();$("#gamePanelDiv").css("background","#fff");$("#gameContentDiv").show();$("#gameContentDiv").addClass("be-loading-active");$("#gameContentDiv").append('<div class="be-spinner"><svg width="40px" height="40px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg"><circle fill="none" stroke-width="4" stroke-linecap="round" cx="33" cy="33" r="30" class="circle"><\/circle><\/svg><\/div>');game.UI=n;var u="/Game/GetModule?partialName="+g_areaArray[n.valueOf()-1];r!=null&&(u+="&param1="+r);$("#gameContentDiv").load(u,function(){t!=null&&t();i==0&&$(window).width()>=1200?$("#gameContentCityDiv").css("visibility","hidden"):($("#gameContentCityDiv").css("display","none"),$("#gameContentDiv").css("position","initial"));$("#gameContentDiv").removeClass("be-loading-active")})}}function CloseArea(){game.UI=UI.City;$("#gameContentDiv").empty();$("#gameContentDiv").hide();$("#gamePanelDiv").css("background","none");$("#gameContentCityDiv").css("display","block");$("#gameContentDiv").css("position","absolute");$("#gameContentCityDiv").css("visibility","visible")}function CloseAreaAccept(){$("#md-closeAreaAccept").niftyModal()}function LoadIndexArea(n,t,i,r,u){$(t).empty();var f="/Game/GetModuleIndex?partialName="+n;u!=null&&(f+="&param1="+u);i==!1||i==null?$(t).load(f,function(){r!=null&&r()}):$.get(f,function(n){$(t).after(n);r!=null&&r()})}function NotificationAlert(n,t,i=NotificationType.Information,r=false){var u="primary";i==NotificationType.Success?u="success":i==NotificationType.Alert&&(u="danger");$.gritter.add({title:n,text:t,class_name:"color "+u});r&&"Notification"in window&&Notification.requestPermission(function(){var i=new Notification(n,{body:t})})}function UICenterDiv(n){$(window).width()>=1200?$(n).css({position:"absolute",left:"50%",top:"50%","margin-left":-$(n).outerWidth()/2,"margin-top":-$(n).outerHeight()/2}):$(n).css({position:"inherit",left:"initial",top:"initial","margin-left":"initial","margin-top":"initial"})}function SkillIncrease(n){$.ajax({data:{id:n},url:"/Game/AjaxAddSkill",success:function(){GameUpdateCharacter()}})}function LoadSaleTab(){$("#sale").load("/Game/GetModule?partialName=_ShopSalePartial.cshtml")}function ItemDescription(n){var t=$("#itemPopup"+n);t.css("display")=="none"?t.css("display","block"):t.css("display","none")}function PurchaseItem(n){game.UI==UI.Shop&&$.ajax({data:{id:n},url:"/Game/AjaxPurchaseItem",success:function(n){$.each(n,function(n,t){t.Success=="true"?NotificationAlert(t.Title,t.Msg,NotificationType.Success):NotificationAlert(t.Title,t.Msg,NotificationType.Alert);GameUpdateGold();GameUpdateInventoryWeight();GameUpdateInventoryBricABrac()})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function PurchaseItemArtifact(n){game.UI==UI.Shop&&$.ajax({data:{id:n},url:"/Game/AjaxPurchaseItemArtifact",success:function(n){$.each(n,function(n,t){t.Success=="true"?NotificationAlert(t.Title,t.Msg,NotificationType.Success):NotificationAlert(t.Title,t.Msg,NotificationType.Alert);GameUpdateArtifacts();GameUpdateInventoryWeight();GameUpdateInventoryBricABrac()})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function SaleItemDescription(n){var t=$("#saleItemPopup"+n);t.css("display")=="none"?t.css("display","block"):t.css("display","none")}function ConvertArtifactToGold(){game.UI==UI.Shop&&$.ajax({url:"/Game/AjaxConvertArtifactToGold",success:function(n){$.each(n,function(n,t){t.Success=="true"?(NotificationAlert(t.Title,t.Msg,NotificationType.Success),GameUpdateGold(),GameUpdateArtifacts()):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function SaleItem(n,t){game.UI==UI.Shop&&$.ajax({data:{id:n},url:"/Game/AjaxSaleItem",success:function(n){$.each(n,function(n,i){i.Success=="true"?NotificationAlert(i.Title,i.Msg,NotificationType.Success):NotificationAlert(i.Title,i.Msg,NotificationType.Alert);GameUpdateGold();GameUpdateInventoryWeight();GameUpdateInventoryBricABrac();$("#SaleItem"+t).hide()})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function StartJob(){g_currentJobId!=0&&$.ajax({data:{id:g_currentJobId},url:"/Game/AjaxStartWork",success:function(n){$.each(n,function(n,t){t.Success=="true"?(NotificationAlert(t.Title,t.Msg,NotificationType.Success),LoadArea(UI.AtWork,function(){$("#atWorkProgressBar").progressTimer({timeLimit:$("#TimeInput"+g_currentJobId).val(),baseStyle:"progress-bar-primary progress-bar-striped active",warningStyle:"progress-bar-primary progress-bar-striped active",completeStyle:"progress-bar-success progress-bar-striped active",eachIteration:function(n){var t=Math.ceil(($("#TimeInput"+g_currentJobId).val()*1e3-n)/3e5);t<1?$("#atWorkArtifactPrice").text("1"):$("#atWorkArtifactPrice").text(t)},onFinish:function(){$("#atWorkBtn").empty();NotificationAlert(t.Title,t.FinishedMsg,NotificationType.Information,!0);$("#atWorkBtn").html('<a onclick="RecoverJob()" class="btn btn-space btn-success"><i class="icon icon-left mdi mdi-check"><\/i> '+t.ButtonTxt+"<\/a>")}});var n=Math.ceil($("#TimeInput"+g_currentJobId).val()/300);$("#atWorkArtifactPrice").text(n)})):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function RecoverJob(){$.ajax({url:"/Game/AjaxRecoverWork",success:function(n){$.each(n,function(n,t){t.Success=="true"?(NotificationAlert(t.Title,t.Msg,NotificationType.Success),GameUpdateGold(),CloseArea()):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function AccelerateJob(){$.ajax({url:"/Game/AjaxAccelerateWork",success:function(n){$.each(n,function(n,t){t.Success=="true"?($("#atWorkBtn").empty(),$("#atWorkBtn").html('<a onclick="RecoverJob()" class="btn btn-space btn-success"><i class="icon icon-left mdi mdi-check"><\/i> '+t.ButtonTxt+"<\/a>"),GameUpdateArtifacts()):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function StopJob(){$.ajax({url:"/Game/AjaxStopWork",success:function(n){$.each(n,function(n,t){t.Success=="true"?(NotificationAlert(t.Title,t.Msg,NotificationType.Information),CloseArea()):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function Care(){$.ajax({url:"/Game/AjaxCare",success:function(n){$.each(n,function(n,t){t.Success=="true"?(NotificationAlert(t.Title,t.Msg,NotificationType.Success),GameUpdateGold(),GameUpdateLife()):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function NiftyResetCharacter(){$("#md-resetCharacter").niftyModal()}function ResetStats(){$.ajax({url:"/Game/AjaxResetStats",success:function(n){$.each(n,function(n,t){t.Success=="true"?(NotificationAlert(t.Title,t.Msg,NotificationType.Success),GameUpdateCharacter()):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function PurchasePotion(n){$.ajax({data:{id:n},url:"/Game/AjaxPurchasePotion",success:function(n){$.each(n,function(n,t){t.Success=="true"?(NotificationAlert(t.Title,t.Msg,NotificationType.Success),GameUpdateCharacter(),GameUpdateGold()):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function PurchaseCompanion(n){$.ajax({data:{id:n},url:"/Game/AjaxPurchaseCompanion",success:function(n){$.each(n,function(n,t){t.Success=="true"?(NotificationAlert(t.Title,t.Msg,NotificationType.Success),GameUpdateGold()):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function StartHeroQuest(n){LoadArea(UI.HeroQuest,null,0,n)}function AccelerateHeroQuest(){$.ajax({url:"/Game/AjaxAccelerateHeroQuest",success:function(n){$.each(n,function(n,t){t.Success=="true"?(GameUpdateArtifacts(),$("#heroQuestDivCenter").empty(),$("#heroQuestDivCenter").html('<a onclick="HeroQuestNextStep(2)" class="btn btn-space btn-primary">'+t.BtnNextStep+"<\/a>")):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function HeroQuestNextStep(n){$.getJSON("/Game/AjaxGetNextStep?id="+n,function(n){$.each(n,function(n,t){var r,u,i;if(t.Step==1)$("#heroQuestDivCenter").progressTimer({timeLimit:t.Time,start:new Date(Date.parse(t.Start)),baseStyle:"progress-bar-primary progress-bar-striped active",warningStyle:"progress-bar-primary progress-bar-striped active",completeStyle:"progress-bar-success progress-bar-striped active",eachIteration:function(n){var i=Math.ceil((t.Time*1e3-n)/3e5);i<1?$("#atHeroQuestArtifactPrice").text("1"):$("#atHeroQuestArtifactPrice").text(i)},onFinish:function(){$("#heroQuestDivCenter").empty();$("#heroQuestDivCenter").html('<a onclick="HeroQuestNextStep(2)" class="btn btn-space btn-primary">'+t.BtnNextStep+"<\/a>");NotificationAlert("Le mythe des montagnes",t.BtnNextStep,NotificationType.Information,!0)}}),$("#heroQuestDivCenter").append('<a onclick="AccelerateHeroQuest()" class="btn btn-space btn-success"><i class="icon icon-left mdi mdi-check"><\/i> '+t.BtnFinished+' (<span id="atHeroQuestArtifactPrice">-<\/span> '+t.ArtifactTxt+")<\/a>");else if(t.Step==2)$("#heroQuestDivCenter").empty(),$("#heroQuestDivCenter").load("/Game/GetModule?partialName=_AtBattlePVEPartial.cshtml",function(){$.getJSON("/Game/AjaxRealTimeBattle",function(n){$.each(n,function(n,t){t.finished!="true"?(UICenterDiv("#heroQuestDivCenter"),$("#BattleUserLifeDiv").css("width",t.UserLifePercentage+"%"),$("#BattleUserLifeText").text(t.UserLife),$("#BattleUserEnergyDiv").css("width",t.UserEnergyPercentage+"%"),$("#BattleUserEnergyText").text(t.UserEnergy),$("#BattleMonsterLifeDiv").css("width",t.EntityLifePercentage+"%"),$("#BattleMonsterLifeText").text(t.EntityLife),$("#BattleMonsterEnergyDiv").css("width",t.EntityEnergyPercentage+"%"),$("#BattleMonsterEnergyText").text(t.EntityEnergy),$("#BattleTimer").progressTimer({timeLimit:g_currentTimer,baseStyle:"progress-bar-primary",warningStyle:"progress-bar-primary",completeStyle:"progress-bar-primary",allTheTime:function(n){g_currentTimer!=n.timeLimit&&(n.timeLimit=g_currentTimer)},onFinish:function(){BattleUpdateProgressTimer("#BattleTimer",new Date,"primary","HeroQuestNextStep(3)");AtBattlePVE("HeroQuestNextStep(3)")}})):(GameUpdateRankingHunt(),$("#heroQuestDivCenter").empty(),$("#heroQuestDivCenter").html('<a onclick="HeroQuestNextStep(3)" class="btn btn-space btn-primary">'+t.BtnNextStep+"<\/a>"))})})});else if(t.Step==3){for(GameUpdateRankingHunt(),GameUpdateInventoryWeight(),GameUpdateInventoryBricABrac(),GameUpdateCharacter(),r='<div class="row row-centered"><div class="col-md-4 col-centered">',u="",i=0;i<t.ItemNumber;i++)u+='<tr><td class="user-avatar">',t.ItemArray[i].Img!="none"&&(u+='<img alt="Avatar" src="'+t.ItemArray[i].Img+'">'),u+=t.ItemArray[i].Title+"<\/td><td>"+t.ItemArray[i].Text+"<\/td><\/tr>";r+='<table class="table"><tbody><tr id="goldandartifacts"><td class="user-avatar"> <img alt="Gold" src= "/images/Game/gold.svg" > '+t.Gold+" "+t.GoldTxt+'<\/td><td class="user-avatar" > <img style="transform: scale(1.5);" alt="Xp" src= "/images/Game/xp.svg"> '+t.Xp+" "+t.XpTxt+"<\/td ><\/tr>"+u+"<\/tbody><\/table>";r+='<div style="text-align: center;"><a onclick="HeroQuestNextStep(4)" class="btn btn-space btn-primary">'+t.BtnGetReward+"<\/a><\/div>";r+="<\/div><\/div>";$("#heroQuestDivCenter").empty();$("#heroQuestDivCenter").html(r);UICenterDiv("#heroQuestDivCenter")}else(t.Step==0||t.Step==-1)&&(GameUpdateGold(),GameUpdateLife(),GameUpdateCharacter(),CloseArea())});game.GetPlayer().Update()})}function StartNarrativeQuest(n){LoadArea(UI.AtNarrativeQuest,null,1,n)}function AccelerateNarrativeQuest(){$.ajax({url:"/Game/AjaxAccelerateNarrativeQuest",success:function(n){$.each(n,function(n,t){t.Success=="true"?(GameUpdateArtifacts(),$("#heroQuestDivCenter").empty(),$("#heroQuestDivCenter").html('<a onclick="NarrativeQuestNextStep()" class="btn btn-space btn-primary">'+t.BtnNextStep+"<\/a>")):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function NarrativeQuestNextStep(n=null){var t="/Game/AjaxNarrativeGetNextStep";n!=null&&(t+="?id="+n);$.getJSON(t,function(n){$.each(n,function(n,t){var r,u,i;if(t.Step==0)$("#heroQuestDivCenter").progressTimer({timeLimit:t.Time,start:new Date(t.Start),baseStyle:"progress-bar-primary progress-bar-striped active",warningStyle:"progress-bar-primary progress-bar-striped active",completeStyle:"progress-bar-success progress-bar-striped active",eachIteration:function(n){var i=Math.ceil((t.Time*1e3-n)/3e5);i<1?$("#atNarrativeQuestArtifactPrice").text("1"):$("#atNarrativeQuestArtifactPrice").text(i)},onFinish:function(){$("#heroQuestDivCenter").empty();NarrativeQuestNextStep()}}),$("#heroQuestDivCenter").append('<a onclick="AccelerateNarrativeQuest()" class="btn btn-space btn-success"><i class="icon icon-left mdi mdi-check"><\/i> '+t.BtnFinished+' (<span id="atNarrativeQuestArtifactPrice">-<\/span> '+t.ArtifactTxt+")<\/a>");else if(t.Step==-10){for($("#questImgBackground").css("visibility","hidden"),GameUpdateRankingHunt(),GameUpdateInventoryWeight(),GameUpdateInventoryBricABrac(),GameUpdateCharacter(),r='<div class="row row-centered"><div class="col-md-4 col-centered">',u="",i=0;i<t.ItemNumber;i++)u+='<tr><td class="user-avatar">',t.ItemArray[i].Img!="none"&&(u+='<img alt="Avatar" src="'+t.ItemArray[i].Img+'">'),u+=t.ItemArray[i].Title+"<\/td><td>"+t.ItemArray[i].Text+"<\/td><\/tr>";r+='<table class="table"><tbody><tr id="goldandartifacts"><td class="user-avatar"> <img alt="Gold" src= "/images/Game/gold.svg" > '+t.Gold+" "+t.GoldTxt+'<\/td><td class="user-avatar" > <img style="transform: scale(1.5);" alt="Xp" src= "/images/Game/xp.svg"> '+t.Xp+" "+t.XpTxt+"<\/td ><\/tr>"+u+"<\/tbody><\/table>";r+='<div style="text-align: center;"><a onclick="NarrativeQuestNextStep()" class="btn btn-space btn-primary">'+t.BtnGetReward+"<\/a><\/div>";r+="<\/div><\/div>";$("#heroQuestDivCenter").empty();$("#heroQuestDivCenter").html(r);UICenterDiv("#heroQuestDivCenter")}else t.Step==-11||t.Step==-12?(GameUpdateGold(),GameUpdateLife(),GameUpdateCharacter(),CloseArea()):($("#questImgBackground").css("visibility","visible"),t.Type==1?($("#questImgBackground").css("visibility","visible"),$("#heroQuestDivCenter").empty(),$("#heroQuestDivCenter").load("/Game/GetModule?partialName=_AtNarrativePartial.cshtml")):t.Type==2&&($("#questImgBackground").css("visibility","hidden"),$("#heroQuestDivCenter").empty(),$("#heroQuestDivCenter").load("/Game/GetModule?partialName=_AtBattlePVEPartial.cshtml",function(){$.getJSON("/Game/AjaxRealTimeBattle?id=total",function(n){$.each(n,function(n,t){t.finished!="true"?(UICenterDiv("#heroQuestDivCenter"),$("#BattleUserLifeDiv").css("width",t.UserLifePercentage+"%"),$("#BattleUserLifeText").text(t.UserLife),$("#BattleUserEnergyDiv").css("width",t.UserEnergyPercentage+"%"),$("#BattleUserEnergyText").text(t.UserEnergy),$("#BattleMonsterLifeDiv").css("width",t.EntityLifePercentage+"%"),$("#BattleMonsterLifeText").text(t.EntityLife),$("#BattleMonsterEnergyDiv").css("width",t.EntityEnergyPercentage+"%"),$("#BattleMonsterEnergyText").text(t.EntityEnergy),$("#BattleTimer").progressTimer({timeLimit:g_currentTimer,baseStyle:"progress-bar-primary",warningStyle:"progress-bar-primary",completeStyle:"progress-bar-primary",allTheTime:function(n){g_currentTimer!=n.timeLimit&&(n.timeLimit=g_currentTimer)},onFinish:function(){BattleUpdateProgressTimer("#BattleTimer",new Date,"primary","NarrativeQuestNextStep()");AtBattlePVE("NarrativeQuestNextStep()")}})):($("#heroQuestDivCenter").empty(),$("#heroQuestDivCenter").html('<a onclick="NarrativeQuestNextStep()" class="btn btn-space btn-primary">'+t.BtnNextStep+"<\/a>"))})})})))});game.GetPlayer().Update()})}function AtBattlePVE(n){$.getJSON("/Game/AjaxRealTimeBattle?userSkill="+g_currentSkill,function(t){$.each(t,function(t,i){var u,r;i.finished!="true"?($("#atBattlePlayerSkill"+g_currentSkill).fadeIn("fast",function(){$("#atBattlePlayerSkill"+g_currentSkill).delay(600).fadeOut(400)}),$("#atBattleMonsterSkill"+i.EntitySkillId).fadeIn("fast",function(){$("#atBattleMonsterSkill"+i.EntitySkillId).delay(600).fadeOut(400)}),$("#lapsLeftDiv").text(parseInt($("#lapsLeftDiv").text())-1),u=[{label:"Rest",data:parseInt($("#lapsLeftDiv").text())},{label:"Pass",data:20-parseInt($("#lapsLeftDiv").text())},],$.plot("#laps-left",u,{series:{pie:{radius:.75,innerRadius:.58,show:!0,highlight:{opacity:.1},label:{show:!1}}},grid:{hoverable:!0},legend:{show:!1},colors:["#34a853;","#f5f5f5"]}),$("#BattleUserLifeDiv").css("width",i.UserLifePercentage+"%"),$("#BattleUserLifeText").text(i.UserLife),$("#BattleUserEnergyDiv").css("width",i.UserEnergyPercentage+"%"),$("#BattleUserEnergyText").text(i.UserEnergy),$("#BattleMonsterLifeDiv").css("width",i.EntityLifePercentage+"%"),$("#BattleMonsterLifeText").text(i.EntityLife),$("#BattleMonsterEnergyDiv").css("width",i.EntityEnergyPercentage+"%"),$("#BattleMonsterEnergyText").text(i.EntityEnergy)):(GameUpdateRankingHunt(),r="",i.Win=="false"&&(r+="<h3>"+i.HeaderTitle+"<\/h3><br/>"),r+='<a onclick="'+n+'" class="btn btn-space btn-primary" > '+i.BtnNextStep+"<\/a>",$("#heroQuestDivCenter").empty(),$("#heroQuestDivCenter").html(r),UICenterDiv("#heroQuestDivCenter"))})})}function BattleUpdateProgressTimer(n,t,i,r){$(n).progressTimer({timeLimit:g_currentTimer,extra:100,baseStyle:"progress-bar-"+i,warningStyle:"progress-bar-"+i,completeStyle:"progress-bar-"+i,allTheTime:function(n){g_currentTimer!=n.timeLimit&&(n.timeLimit=g_currentTimer)},onFinish:function(){BattleUpdateProgressTimer(n,new Date,i,r);AtBattlePVE(r)}})}function AtBattlePVEBuff(){$.ajax({url:"/Game/AjaxRealTimeBattleBuff",success:function(n){$.each(n,function(n,t){t.Success=="true"?(NotificationAlert(t.Title,t.Msg,NotificationType.Success),$("#BattleUserEnergyDiv").css("width","100%"),$("#BattleUserEnergyText").text("100%"),$("#UserStrengthAdd").text(parseInt($("#UserStrength").text())+parseInt($("#UserStrengthAdd").text())),$("#UserDefenseAdd").text(parseInt($("#UserDefense").text())+parseInt($("#UserDefenseAdd").text())),GameUpdateArtifacts()):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function atBattleSelectSkill(n){$("#skill"+g_currentSkill).removeClass("active");g_currentSkill=n;$("#skill"+g_currentSkill).addClass("active")}function atBattleSelectSpeed(n){$("#speedBtn"+g_currentTimer).removeAttr("class");$("#speedBtn"+g_currentTimer).addClass("btn btn-primary");g_currentTimer=n;$("#speedBtn"+g_currentTimer).removeAttr("class");$("#speedBtn"+g_currentTimer).addClass("btn btn-success")}function atBattleAbandonConfirm(){$("#md-atBattleAbandon").niftyModal()}function atBattleAbandon(){$.ajax({url:"/Game/AjaxRealTimeBattleAbandon",success:function(n){$.each(n,function(n,t){t.Success=="true"?($("#BattleUserLifeDiv").css("width","0%"),$("#BattleUserLifeText").text("0")):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function CompanionAddToFavorite(n){$.ajax({data:{id:n},url:"/Game/AjaxAddFavoriteCompanion",success:function(t){$.each(t,function(t,i){i.Success=="true"?(NotificationAlert(i.Title,i.Msg,NotificationType.Success),$("#FavoriteBtn"+n).text(i.BtnText),$("#FavoriteBtn"+n).attr("onclick","CompanionDeleteToFavorite("+n+")"),GameUpdateCompanion()):NotificationAlert(i.Title,i.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function CompanionDeleteToFavorite(n){$.ajax({data:{id:n},url:"/Game/AjaxDeleteFavoriteCompanion",success:function(t){$.each(t,function(t,i){i.Success=="true"?(NotificationAlert(i.Title,i.Msg,NotificationType.Success),$("#FavoriteBtn"+n).text(i.BtnText),$("#FavoriteBtn"+n).attr("onclick","CompanionAddToFavorite("+n+")"),GameUpdateCompanion()):NotificationAlert(i.Title,i.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function CompanionSendBackConfirm(n){$("#md-deleteCompanion").remove();LoadIndexArea("_DeleteCompanionModalPartial.cshtml","#md-apothecary",!0,function(){$("#md-deleteCompanion").niftyModal()},n)}function CompanionSendBack(n){$.ajax({data:{id:n},url:"/Game/AjaxSendBackCompanion",success:function(t){$.each(t,function(t,i){i.Success=="true"?(NotificationAlert(i.Title,i.Msg,NotificationType.Success),$("#CompanionsItem"+n).hide(),GameUpdateCompanion()):NotificationAlert(i.Title,i.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function AddCompanionSlot(){$.ajax({url:"/Game/AjaxAddCompanionSlot",success:function(n){$.each(n,function(n,t){t.Success=="true"?NotificationAlert(t.Title,t.Msg,NotificationType.Success):NotificationAlert(t.Title,t.Msg,NotificationType.Alert);GameUpdateArtifacts()})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function GameUpdateCompanion(){LoadIndexArea("_CompanionPartial.cshtml","#companionDiv",!1,function(){$.getJSON("/Game/AjaxGetOnQuest",function(n){$.each(n,function(n,t){n!="success"&&($("#onQuestBtn"+t.TeamId).empty(),$("#onQuestBtn"+t.TeamId).html('<button onclick="AccelerateCompanionQuestConfirm( '+t.TeamId+')" class="btn btn-default btn-success" type="button"><i class="icon mdi mdi-check" style="color: white;"><\/i><\/button>'),$("#onQuestProgressBar"+t.TeamId).empty(),$("#onQuestProgressBar"+t.TeamId).progressTimer({timeLimit:t.Time,start:new Date(t.Start),baseStyle:"progress-bar-primary",warningStyle:"progress-bar-primary",completeStyle:"progress-bar-success",onFinish:function(){NotificationAlert(t.BtnText,"",NotificationType.Information,!0);$("#onQuestProgressBar"+t.TeamId).empty();$("#onQuestBtn"+t.TeamId).empty();$("#onQuestProgressBar"+t.TeamId).html('<a onclick="RecoverCompanionQuest('+t.TeamId+')" class="btn btn-space btn-success"><i class="icon icon-left mdi mdi-check"><\/i> '+t.BtnText+"<\/a>")}}))})})})}function AccelerateCompanionQuestConfirm(n){$("#md-accelerateCompanionQuest").remove();LoadIndexArea("_AccelerateCompanionModalPartial.cshtml","#md-apothecary",!0,function(){$("#md-accelerateCompanionQuest").niftyModal()},n)}function AccelerateCompanionQuest(n){$.ajax({data:{id:n},url:"/Game/AjaxAccelerateCompanionQuest",success:function(n){$.each(n,function(n,t){t.Success=="true"?(GameUpdateArtifacts(),GameUpdateCompanion()):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function OpenCompanionQuestsWindow(n,t){$("#md-CompanionMission").remove();LoadIndexArea("_CompanionModalPartial.cshtml","#md-apothecary",!0,function(){g_currentCompanionId=n;$("#md-CompanionMission").niftyModal();$('input:radio[name="radCompanionQuest"]').change(function(){g_currentCompanionQuestId=$(this).val();$("#CompanionQuestProceed").prop("disabled",!1)})},t)}function StartCompanionQuest(){if(g_currentCompanionQuestId!=0){var n=g_currentCompanionId;$.ajax({data:{teamId:n,questId:g_currentCompanionQuestId},url:"/Game/AjaxCompanionStartQuest",success:function(n){$.each(n,function(n,t){t.Success=="true"?(NotificationAlert(t.Title,t.Msg,NotificationType.Success),GameUpdateCompanion()):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}}function RecoverCompanionQuest(n){$.ajax({data:{id:n},url:"/Game/AjaxRecoverCompanionQuest",success:function(n){$.each(n,function(n,t){t.Success=="true"?(NotificationAlert(t.Title,t.Msg,NotificationType.Success),GameUpdateGold(),GameUpdateCharacter(),GameUpdateCompanion(),game.Update()):(NotificationAlert(t.Title,t.Msg,NotificationType.Alert),GameUpdateCompanion())})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function GameUpdateSkills(){LoadIndexArea("_SkillsPartial.cshtml","#skillsDiv")}function SelectSkill(n){$.ajax({data:{id:n},url:"/Game/AjaxSelectSkill",success:function(t){$.each(t,function(t,i){i.Success=="true"?$("#skillSelect"+n).hasClass("active")?$("#skillSelect"+n).removeClass("active"):$("#skillSelect"+n).addClass("active"):NotificationAlert(i.Title,i.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function GameUpdateInventoryEquipment(){LoadIndexArea("_InventoryEquipmentPartial.cshtml","#inventoryEquipmentDiv")}function GameUpdateInventoryBricABrac(){LoadIndexArea("_InventoryPartial.cshtml","#inventoryBricabracDiv")}function EquipItem(n){$.ajax({data:{id:n},url:"/Game/AjaxEquipItem",success:function(n){$.each(n,function(n,t){t.Success=="true"?(NotificationAlert(t.Title,t.Msg,NotificationType.Success),GameUpdateInventoryEquipment(),GameUpdateInventoryWeight(),GameUpdateInventoryBricABrac(),GameUpdateCharacter()):NotificationAlert(t.Title,t.Msg,NotificationType.Alert)})},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function UnequipItem(n){$.ajax({data:{id:n},url:"/Game/AjaxUnequipItem",success:function(){GameUpdateInventoryEquipment();GameUpdateInventoryWeight();GameUpdateInventoryBricABrac();GameUpdateCharacter()},error:function(n,t,i){NotificationAlert("Error","Internal Error: "+i,NotificationType.Alert)}})}function GameUpdateRankingHunt(){LoadIndexArea("_HuntingPartial.cshtml","#rankingHuntingDiv")}var g_lang="",g_currentJobId=0,g_currentCompanionId=0,g_currentCompanionSendBackId=0,g_currentCompanionQuestId=0,g_skillPointsDiv=0,g_currentSkill=1,g_currentTimer=6,g_areaArray=["_ShopPartial.cshtml","_TavernPartial.cshtml","_ArenaPartial.cshtml","_HeroQuestPartial.cshtml","_AtWorkPartial.cshtml","_CompanionManagementPartial.cshtml","_ManorPartial.cshtml","_AtNarrativeQuestPartial.cshtml"],NotificationType,UI,game;(function(n){n[n.Success=0]="Success";n[n.Information=1]="Information";n[n.Alert=2]="Alert"})(NotificationType||(NotificationType={})),function(n){n[n.City=0]="City";n[n.Shop=1]="Shop";n[n.Tavern=2]="Tavern";n[n.Arena=3]="Arena";n[n.HeroQuest=4]="HeroQuest";n[n.AtWork=5]="AtWork";n[n.CompanionManagement=6]="CompanionManagement";n[n.Manor=7]="Manor";n[n.AtNarrativeQuest=8]="AtNarrativeQuest"}(UI||(UI={}));class GameClass{constructor(){this.UI=UI.City;this.player=new PlayerClass}Update(){$("#JsGold").text(this.gold);$("#JsArtifacts").text(this.artifacts);this.player.Update()}GetPlayer(){return this.player}}class PlayerClass{Update(){$(".JsLevel").text(this.Level);$("#JsLife").css("width",this.Life+"%");$("#JsLifeText").text(this.Life);$("#JsXp").css("width",this.Xp+"%");$("#JsXpText").text(this.Xp);$("#JsStrength").text(this.Strength);$("#JsDefense").text(this.Defense);$("#JsEnergy").text(this.Energy);$("#skillPointsDiv").text(g_skillPointsDiv);(this.StrengthAdd!=0||this.StrengthAdd!=null)&&$("#JsStrengthAdd").text("(+"+this.StrengthAdd+")");(this.DefenseAdd!=0||this.DefenseAdd!=null)&&$("#JsDefenseAdd").text("(+"+this.DefenseAdd+")");(this.EnergyAdd!=0||this.EnergyAdd!=null)&&$("#JsEnergyAdd").text("(+"+this.EnergyAdd+")")}}game=new GameClass;